<script>
const sheetID = "1u7sHZTiuVvw9l1OHethOqi2lGhO-9c09ieN2Rvwye1w";
const sheetName = "das_provi";

// Ambil data dalam format CSV dari Google Sheets
const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:csv&sheet=${sheetName}`;

fetch(url)
  .then(res => res.text())
  .then(csv => {
    const rows = csv.split("\n").map(r => r.split(","));
    const table = document.getElementById("data");

    // Buang 2 baris pertama (ambil mulai baris ke-3)
    const filteredRows = rows.slice(2);

    if (filteredRows.length === 0) {
      table.innerHTML = "<tr><td>Tidak ada data</td></tr>";
      return;
    }

    // Buat header dari kolom C ke kanan (indeks 2)
    const headers = filteredRows[0].slice(2);
    const thead = document.createElement("thead");
    const headerRow = document.createElement("tr");
    headers.forEach(h => {
      const th = document.createElement("th");
      th.textContent = h.replace(/(^"|"$)/g, ""); // hapus tanda kutip
      headerRow.appendChild(th);
    });
    thead.appendChild(headerRow);
    table.appendChild(thead);

    // Buat isi tabel
    const tbody = document.createElement("tbody");
    for (let i = 1; i < filteredRows.length; i++) {
      const row = filteredRows[i].slice(2);
      const tr = document.createElement("tr");
      row.forEach(val => {
        const td = document.createElement("td");
        td.textContent = val.replace(/(^"|"$)/g, "");
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    }
    table.appendChild(tbody);
  })
  .catch(err => {
    console.error("Gagal memuat data:", err);
    document.getElementById("data").innerHTML = "<tr><td>Gagal memuat data</td></tr>";
  });
</script>
