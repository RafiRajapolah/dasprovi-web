<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data dari Sheet: das_provi</title>

<style>
  body {
    font-family: "Segoe UI", Arial, sans-serif;
    background-color: #f6f8fa;
    margin: 0;
    padding: 20px;
    color: #222;
  }

  h1 {
    text-align: center;
    margin-bottom: 20px;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    background: #fff;
    box-shadow: 0 3px 10px rgba(0,0,0,0.05);
    border-radius: 8px;
    overflow: hidden;
  }

  th {
    background: #2e7d32; /* hijau tua */
    color: white;
    padding: 10px;
    text-align: center;
    font-weight: 600;
    border: 1px solid #ddd;
  }

  td {
    border: 1px solid #eee;
    padding: 8px;
    text-align: center;
  }

  tr:nth-child(even) {
    background: #f9f9f9;
  }

  tr:hover {
    background: #e8f5e9;
  }

  .footer {
    text-align: center;
    color: #777;
    margin-top: 20px;
    font-size: 0.9em;
  }
</style>
</head>
<body>

<h1>ðŸ“Š Data dari Sheet: das_provi</h1>
<table id="data"></table>

<div class="footer">Terakhir diperbarui otomatis dari Google Sheet</div>

<script>
const sheetID = "1u7sHZTiuVvw9l1OHethOqi2lGhO-9c09ieN2Rvwye1w";
const sheetName = "das_provi";
const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:csv&sheet=${sheetName}`;

fetch(url)
  .then(res => res.text())
  .then(csv => {
    const rows = csv.split("\n").map(r => r.split(","));
    const table = document.getElementById("data");

    // Skip baris 1-4 (judul & merge header)
    const filteredRows = rows.slice(4);

    if (filteredRows.length === 0) {
      table.innerHTML = "<tr><td>Tidak ada data</td></tr>";
      return;
    }

    // Header manual (karena header di sheet merge)
    const headers = [
      "TEKNISI",
      "TSEL AO", "TSEL MO",
      "INDIBIZ AO", "INDIBIZ MO",
      "SURVEY", "TARIK DC", "BAI",
      "PS", "KENDALA", "SISA WO"
    ];

    const thead = document.createElement("thead");
    const headerRow = document.createElement("tr");
    headers.forEach(h => {
      const th = document.createElement("th");
      th.textContent = h;
      headerRow.appendChild(th);
    });
    thead.appendChild(headerRow);
    table.appendChild(thead);

    // Isi tabel
    const tbody = document.createElement("tbody");
    for (let i = 0; i < filteredRows.length; i++) {
      const row = filteredRows[i].slice(2); // mulai dari kolom C
      if (row.join("").trim() === "") continue;

      const tr = document.createElement("tr");
      row.forEach(val => {
        const td = document.createElement("td");
        td.textContent = val.replace(/(^"|"$)/g, "");
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    }
    table.appendChild(tbody);
  })
  .catch(err => {
    console.error("Gagal memuat data:", err);
    document.getElementById("data").innerHTML =
      "<tr><td>Gagal memuat data</td></tr>";
  });
</script>

</body>
</html>
