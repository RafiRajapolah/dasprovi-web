<script>
const sheetID = "1u7sHZTiuVvw9l1OHethOqi2lGhO-9c09ieN2Rvwye1w";
const sheetName = "das_provi";

const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:csv&sheet=${sheetName}`;

fetch(url)
  .then(res => res.text())
  .then(csv => {
    const rows = csv.split("\n").map(r => r.split(","));
    const table = document.getElementById("data");

    // Buang 4 baris pertama (mulai ambil dari baris ke-5)
    const filteredRows = rows.slice(4);

    if (filteredRows.length === 0) {
      table.innerHTML = "<tr><td>Tidak ada data</td></tr>";
      return;
    }

    // Buat header manual (karena header di spreadsheet merge)
    const headers = [
      "TEKNISI",
      "TSEL AO", "TSEL MO",
      "INDIBIZ AO", "INDIBIZ MO",
      "SURVEY", "TARIK DC", "BAI", "PS", "KENDALA", "SISA WO"
    ];

    const thead = document.createElement("thead");
    const headerRow = document.createElement("tr");
    headers.forEach(h => {
      const th = document.createElement("th");
      th.textContent = h;
      headerRow.appendChild(th);
    });
    thead.appendChild(headerRow);
    table.appendChild(thead);

    // Buat isi tabel
    const tbody = document.createElement("tbody");
    for (let i = 0; i < filteredRows.length; i++) {
      const row = filteredRows[i].slice(2); // mulai dari kolom C
      if (row.join("").trim() === "") continue; // skip baris kosong

      const tr = document.createElement("tr");
      row.forEach(val => {
        const td = document.createElement("td");
        td.textContent = val.replace(/(^"|"$)/g, "");
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    }
    table.appendChild(tbody);
  })
  .catch(err => {
    console.error("Gagal memuat data:", err);
    document.getElementById("data").innerHTML = "<tr><td>Gagal memuat data</td></tr>";
  });
</script>
